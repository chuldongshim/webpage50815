<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-sideprj/hybrid/esp32_hw">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">하드웨어 | Coding is my life... bravo my life...</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://github.com/webpage/docs/sideprj/hybrid/esp32_hw"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="하드웨어 | Coding is my life... bravo my life..."><meta data-rh="true" name="description" content="---"><meta data-rh="true" property="og:description" content="---"><link data-rh="true" rel="icon" href="/webpage/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://github.com/webpage/docs/sideprj/hybrid/esp32_hw"><link data-rh="true" rel="alternate" href="https://github.com/webpage/docs/sideprj/hybrid/esp32_hw" hreflang="en"><link data-rh="true" rel="alternate" href="https://github.com/webpage/docs/sideprj/hybrid/esp32_hw" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/webpage/blog/rss.xml" title="Coding is my life... bravo my life... RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/webpage/blog/atom.xml" title="Coding is my life... bravo my life... Atom Feed"><link rel="stylesheet" href="/webpage/assets/css/styles.612a6376.css">
<link rel="preload" href="/webpage/assets/js/runtime~main.0fb79a31.js" as="script">
<link rel="preload" href="/webpage/assets/js/main.d7834fa7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/webpage/"><div class="navbar__logo"><img src="/webpage/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/webpage/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">나는 개발자다!</b></a><a class="navbar__item navbar__link" href="/webpage/docs/mycareer">경력요약</a><a class="navbar__item navbar__link" href="/webpage/docs/introduce">자기소개</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/webpage/docs/sideprj">사이드프로젝트</a><a class="navbar__item navbar__link" href="/webpage/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/chuldongshim/webpage/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">MyGitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/webpage/docs/sideprj">사이드프로젝트 리스트</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/webpage/docs/sideprj/temperature">1. MBD기반 온도PID제어</a><button aria-label="Toggle the collapsible sidebar category &#x27;1. MBD기반 온도PID제어&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/webpage/docs/sideprj/wiper">2. MBD기반 와이퍼</a><button aria-label="Toggle the collapsible sidebar category &#x27;2. MBD기반 와이퍼&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/webpage/docs/sideprj/window">3. MBD기반 윈도우</a><button aria-label="Toggle the collapsible sidebar category &#x27;3. MBD기반 윈도우&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/webpage/docs/sideprj/hybrid">4. 임베디드 웹서버OTA</a><button aria-label="Toggle the collapsible sidebar category &#x27;4. 임베디드 웹서버OTA&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/webpage/docs/sideprj/hybrid/esp32_mgn">관리</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/webpage/docs/sideprj/hybrid/esp32_sys">시스템</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/webpage/docs/sideprj/hybrid/esp32_hw">하드웨어</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/webpage/docs/sideprj/hybrid/esp32_sw">소프트웨어</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/webpage/docs/sideprj/linux">5. 임베디드 리눅스 (TBD)</a><button aria-label="Toggle the collapsible sidebar category &#x27;5. 임베디드 리눅스 (TBD)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/webpage/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/webpage/docs/sideprj/hybrid"><span itemprop="name">4. 임베디드 웹서버OTA</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">하드웨어</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>하드웨어</h1></header><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="사양">사양<a class="hash-link" href="#사양" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mcu">MCU<a class="hash-link" href="#mcu" title="Direct link to heading">​</a></h3><p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_module_mcu_esp32_devKitC_v4_board-ee5adafa9232993cb5756895c9fcb2ec.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;Modules on ESP32-DevKitC v4&gt;</em></p><ul><li>Internal Memory<ul><li>외부메모리 인터페이스를 지원하기 때문에 내부메모리는 외부메모리에 대한 독립된 캐시로 사용될 수 있다.</li></ul></li><li>External Memory  <ul><li>Supports up to 16 MB off-Chip SPI Flash</li><li>Supports up to 8 MB off-Chip SPI SRAM</li></ul></li><li>IO Usage<ul><li>USB커넥트 양쪽 근처에 그룹화 된 D0, D1, D2, D3, CMD 및 CLK는 내부적으로 ESP32와 SPI메모리(Flash/RAM) 간의 통신에 사용된다.</li></ul></li><li><a href="https://arsviator.blogspot.com/2018/11/esp32-gpio.html" target="_blank" rel="noopener noreferrer">ESP32 GPIO 포트 설명</a><p align="left"><img loading="lazy" src="/webpage/assets/images/mbd_hw_module_mcu_esp32_devkitC_v4_pinout-d9a15f3a32f6ec0e3bd9813d34a1b00b.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;PinMap of ESP32-DevKitC v4&gt;</em></p></li><li>메모리맵<p align="left"><img loading="lazy" src="/webpage/assets/images/mbd_hw_module_mcu_memory_map-899902b24b5ef71de82c6f7b7424639f.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;MemoroyMap in technical reference manual&gt;</em></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mcu비교">MCU비교<a class="hash-link" href="#mcu비교" title="Direct link to heading">​</a></h3><p>ESP32 vs NodeMCU</p><table><thead><tr><th>ESP-WROOM-32</th><th>NodeMCU</th></tr></thead><tbody><tr><td>32bit Xtensa Dual-core</td><td>32bit Xtensa Single-core</td></tr><tr><td>Bluetooth 4.2+wifi</td><td>No Bluetooth</td></tr><tr><td>EEPROM Flash</td><td>No Flash</td></tr><tr><td>160MHz</td><td>80MHz</td></tr><tr><td>CAN protocol</td><td>No CAN protoclo</td></tr><tr><td>34 GPIO pin</td><td>17 GPIO pin</td></tr><tr><td>12 bit ADC</td><td>10 bit ADC</td></tr><tr><td>built-in Hall sensor, temperature sensor</td><td>No built-in sensor</td></tr></tbody></table><p>ESP32 vs ESP-32S</p><table><thead><tr><th>ESP32</th><th>ESP-32S</th></tr></thead><tbody><tr><td>ESP-WROOM-32</td><td>ESP-WROOM-32s</td></tr><tr><td>single-core</td><td>dual-core</td></tr><tr><td>wifi+ble</td><td>wifi+ble</td></tr></tbody></table><p><a href="https://iotassistant.io/news/esp32-s2-vs-esp32/" target="_blank" rel="noopener noreferrer">ESP32-s2</a></p><ul><li>IOT 및 스마트폰을 위한 low power wifi 솔루션(wifi only, no bluetooth support, esp32보다 50% 에너지 효율이 높음)에 적용하기 위해 설계되었다.</li><li>ESP32(Xtensa 32bit LX6 dual core) -&gt; ESP32(Xtensa 32bit LX7 single core)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="데이터시트">데이터시트<a class="hash-link" href="#데이터시트" title="Direct link to heading">​</a></h4><p>ESP32-DevKitC v4는 ESP32-WROOM-32D MCU Core를 사용하는 wifi, Bluetooth 일체형 개발보드 이다.</p><ul><li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/hw-reference/esp32/get-started-devkitc.html" target="_blank" rel="noopener noreferrer">ESP32-DevKitC V4 Getting Started 가이드</a><ul><li>ESP32-DevKitC V4 주요 구성요소</li><li>헤더 Pinmap 및 레이아웃</li></ul></li><li><a href="https://github.com/espressif/esp-idf" target="_blank" rel="noopener noreferrer">ESP-IDF Github 소스</a><ul><li>ESP-IDF를 설치하면 <code>c:\Users\cdshim\esp\esp-idf\</code> 경로에 github에 있는 예제프로그램이 생성된다.</li><li><a href="https://github.com/sglee0223/esp32" target="_blank" rel="noopener noreferrer">esp32_devkit_v4 예제소스 github</a></li></ul></li><li>ESP32-WROOM-32D<ul><li><a href="https://www.espressif.com/sites/default/files/documentation/esp32-wroom-32d_esp32-wroom-32u_datasheet_en.pdf" target="_blank" rel="noopener noreferrer">ESP32-DevKitC V4 mcu hw datasheet : ESP32­WROOM­32D_datasheet_en.pdf</a></li><li><a href="https://dl.espressif.com/dl/schematics/esp32_devkitc_v4-sch.pdf" target="_blank" rel="noopener noreferrer">ESP32-DevKitC V4 회로도 : esp32_devkitc_v4-sch.pdf</a></li></ul></li><li>기타<ul><li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/index.html" target="_blank" rel="noopener noreferrer">ESP-IDF Programming Guide - API Reference</a></li><li><a href="https://coyoteugly.tistory.com/159?category=806422" target="_blank" rel="noopener noreferrer">ESP32-ADC</a></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="펌웨어-참고자료">펌웨어 참고자료<a class="hash-link" href="#펌웨어-참고자료" title="Direct link to heading">​</a></h4><ul><li>ESP32 peripheral<ul><li><a href="https://arsviator.blogspot.com/2018/11/esp32-gpio.html" target="_blank" rel="noopener noreferrer">ESP32 peripheral 설명</a></li><li><a href="https://postpop.tistory.com/15" target="_blank" rel="noopener noreferrer">ESP32 peripheral 설명2</a></li><li><a href="https://arsviator.blogspot.com/search?q=esp32" target="_blank" rel="noopener noreferrer">Deep Sleep &amp; Wake-up</a></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="펌웨어">펌웨어<a class="hash-link" href="#펌웨어" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="부팅과정">부팅과정<a class="hash-link" href="#부팅과정" title="Direct link to heading">​</a></h3><ul><li>링커스크립트 파일(esp32_bootloader.ld)에서 Entry point를 call_start_cpu0()로 정의</li><li>..esp\esp-idf\components\esp_system\port\cpu_start.c -&gt; call_start_cpu0() -&gt; start_cpu0() -&gt; start_cpu0_default() -&gt; main_task() 생성 후 FreeRTOS vTaskStartScheduler()를 호출하여 스케쥴링 시작 -&gt; app_main() 호출 후 main_task 자기 자신 vTaskDelete() -&gt; app_main() 시작</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_ble">FW_BLE<a class="hash-link" href="#fw_ble" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>GUI환경 구축</div><div class="admonitionContent_S0QG"><ul><li>블루투스 통신을 위한 안드로이드 프로그래밍은 진행하지 않고, 앱스토어를 통해 무료설치가 가능한 BlueSPP 앱(원하는 기능을 충분히 구현할 수 있음)을 이용한다.</li><li>최종 GUI는 임베디드 웹서버를 구축한 다음 wifi를 통해 웹브라우저로 웹서버에 접속한다.</li></ul></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론">기초이론<a class="hash-link" href="#기초이론" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ble">BLE<a class="hash-link" href="#ble" title="Direct link to heading">​</a></h5><ul><li>Classic Bluetooth는 항상연결되어 있는 반면 BLE는 일반적으로 대기모드에 있으며 필요한 경우에만 깨어나 전력을 적게 소모한다.</li><li>BLE는 2.4GHz ISM 주파수 대역에서도 작동하므로 Wi-fi와 BLE를 단일 안테나로 사용할 수 있다.</li><li><a href="https://github.com/chegewara/esp32-ble-wiki/issues/5" target="_blank" rel="noopener noreferrer">BLUETOOTH SPECIFICATION Version 5.0 - LIST OF ERROR CODES</a></li><li><a href="https://blog.naver.com/PostView.naver?blogId=cksung71&amp;logNo=10183530219&amp;categoryNo=15&amp;parentCategoryNo=0&amp;viewDate=&amp;currentPage=2&amp;postListTopCurrentPage=1&amp;from=postView&amp;userTopListOpen=true&amp;userTopListCount=30&amp;userTopListManageOpen=false&amp;userTopListCurrentPage=2" target="_blank" rel="noopener noreferrer">중요 - Packet Format 및 Advertising 방법</a></li><li><a href="https://docs.espressif.com/projects/esp-idf/en/stable/api-reference/bluetooth/index.html" target="_blank" rel="noopener noreferrer">EspressIF bluetooth API </a></li><li><a href="https://blog.naver.com/chodahi/221403306027" target="_blank" rel="noopener noreferrer">BLE에서 Pairing 과 Bonding</a></li><li><a href="https://www.hardcopyworld.com/?p=1132" target="_blank" rel="noopener noreferrer">BLE(Bluetooth Low Energy) 이해하기</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="블루투스-프로파일">블루투스 프로파일<a class="hash-link" href="#블루투스-프로파일" title="Direct link to heading">​</a></h5><p>블루투스 프로파일은 블루투스 서비스라고도 하며 블루투스 통신계층 최상단에 있는 일종의 프로토콜로 블루투스에는 수십개의 프로파일 표준이 존재한다.</p><ul><li>SPP<ul><li>블루투스 프로파일 중 SPP(Serial Port Profile)은 블루투스를 통해 RS232와 같은 기능을 하는 서비스다. SPP를 지원하는 블루투스 장치를 PC와 연결하면 PC에 가상 COM포트가 생성되고, 무선으로 RS232통신을 할 수 있다.</li><li>SPP는 블루투스 Classic에서 정의되고 있고, BLE(Bluetooth LE)에는 정의되어 있지 않기 때문에 BLE를 사용하면 PC에 가상 COM포트가 생성되지 않는다.</li></ul></li><li>SSP<ul><li>SSP(Secure Simple Pairing)는 bluetooth 2.1 Spec에 도입되었다.</li><li>SSP를 사용하면 Bluetooth 장치를 더 간단하게 페어링할 수 있다.</li></ul></li><li><a href="https://hubbleconstant.tistory.com/29" target="_blank" rel="noopener noreferrer">보안</a><ul><li>Security Management Protocol(SMP)라고 하는 보안 메커니즘을 제공한다.</li><li>블루투스 v2.1 이전까지는 PIN코드를 입력할 인터페이스가 없는 기기에 하드코딩된 PIN을 사용하는 단순 메커니즘이었는데,</li><li>이후 Diffie-Hellman 키교환방식을 사용하는 SSP(Secure Simple Pairing)라는 인증 메커니즘을 도입하여 PINCODE 입력없이 Pairing이 가능하게 되었다. (SSP를 지원하지 않는 모듈과는 PINCODE 입력이 필요함)</li><li>SSP를 통해서는 블루투스 기기 연결 시 상대기기의 동의를 구한다음 수락을 통해 연결이 성립된다.</li></ul></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="비콘">비콘<a class="hash-link" href="#비콘" title="Direct link to heading">​</a></h5><ul><li>어떤 신호를 알리기 위해 주기적으로 신호를 전송하는 기기를 말하며, 애플이 2013년에 BLE기반에 비콘개념을 적용하여 ibeacon을 발표한 이후 ibeacon을 비콘이라고 부른다. </li><li>비콘은 소량의 패킷 전송으로 동작이 가능하고, 기기를 연결하기 위한 페이링이 불필요하며, 저전력으로 통신하기 때문에 다른 무선 통신기루에 비해 저비용으로 위치를 인식할 수 있다.</li><li>비콘은 장치가 있건 없건 상관없이 특정 장치를 지정하지 않고 주변의 모든 장치에게 일방적으로 일정주기의 신호를 보내기 때문에 비콘을 사용할 경우 장비 접촉없이 beacon이 설치된 곳을 지나가기만 해도 데이터 전송이 가능하다.</li><li><a href="https://blog.naver.com/PostView.naver?blogId=cksung71&amp;logNo=10183539970&amp;categoryNo=15&amp;parentCategoryNo=0&amp;viewDate=&amp;currentPage=2&amp;postListTopCurrentPage=1&amp;from=postView&amp;userTopListOpen=true&amp;userTopListCount=30&amp;userTopListManageOpen=false&amp;userTopListCurrentPage=2" target="_blank" rel="noopener noreferrer">iBeacon Advertising Packet  Data</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ble구성"><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/bluetooth/index.html" target="_blank" rel="noopener noreferrer">BLE구성</a><a class="hash-link" href="#ble구성" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="기능">기능<a class="hash-link" href="#기능" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스">인터페이스<a class="hash-link" href="#인터페이스" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정">레지스터설정<a class="hash-link" href="#레지스터설정" title="Direct link to heading">​</a></h5><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>BT 파라미터 초기화 및 Enable</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * Following parameters can be configured runtime, when call esp_bt_controller_init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> controller_task_stack_size</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Bluetooth controller task stack size</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> controller_task_prio</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// Bluetooth controller task priority</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> hci_uart_no</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                    </span><span class="token comment" style="color:#999988;font-style:italic">// If use UART1/2 as HCI IO interface, indicate UART number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint32_t</span><span class="token plain"> hci_uart_baudrate</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">// If use UART1/2 as HCI IO interface, indicate UART baudrate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> scan_duplicate_mode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// scan duplicate mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> scan_duplicate_type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// scan duplicate type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> normal_adv_size</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// Normal adv size for scan duplicate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> mesh_adv_size</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// Mesh adv size for scan duplicate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint16_t</span><span class="token plain"> send_adv_reserved_size</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Controller minimum memory value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint32_t</span><span class="token plain">  controller_debug_flag</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Controller debug log flag</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> mode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic">// Controller mode: BR/EDR, BLE or Dual Mode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> ble_max_conn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// BLE maximum connection numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> bt_max_acl_conn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// BR/EDR maximum ACL connection numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> bt_sco_datapath</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// SCO data path, i.e. HCI or PCM module</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool auto_latency</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                      </span><span class="token comment" style="color:#999988;font-style:italic">// BLE auto latency, used to enhance classic BT performance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bool bt_legacy_auth_vs_evt</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">// BR/EDR Legacy auth complete event required to  protect from BIAS attack</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * Following parameters can not be configured runtime when call esp_bt_controller_init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * It will be overwrite with a constant value which in menuconfig or from a macro.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     * So, do not modify the value when esp_bt_controller_init()</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">     */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> bt_max_sync_conn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// BR/EDR maximum ACL connection numbers. Effective in menuconfig</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> ble_sca</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// BLE low power crystal accuracy index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> pcm_role</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                       </span><span class="token comment" style="color:#999988;font-style:italic">// PCM role (master &amp; slave)*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint8_t</span><span class="token plain"> pcm_polar</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                      </span><span class="token comment" style="color:#999988;font-style:italic">// PCM polar trig (falling clk edge &amp; rising clk edge)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint32_t</span><span class="token plain"> magic</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                         </span><span class="token comment" style="color:#999988;font-style:italic">// Magic number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token class-name">esp_bt_controller_config_t</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">define</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property macro-name function" style="color:#d73a49">BT_CONTROLLER_INIT_CONFIG_DEFAULT</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token macro property expression" style="color:#36acaa"> </span><span class="token macro property expression punctuation" style="color:#393A34">{</span><span class="token macro property expression" style="color:#36acaa">                              </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">controller_task_stack_size </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> ESP_TASK_BT_CONTROLLER_STACK</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">            </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">controller_task_prio </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> ESP_TASK_BT_CONTROLLER_PRIO</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                   </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">hci_uart_no </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> BT_HCI_UART_NO_DEFAULT</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                                 </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">hci_uart_baudrate </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> BT_HCI_UART_BAUDRATE_DEFAULT</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                     </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">scan_duplicate_mode </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> SCAN_DUPLICATE_MODE</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                            </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">scan_duplicate_type </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> SCAN_DUPLICATE_TYPE_VALUE</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                      </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">normal_adv_size </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> NORMAL_SCAN_DUPLICATE_CACHE_SIZE</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                   </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">mesh_adv_size </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> MESH_DUPLICATE_SCAN_CACHE_SIZE</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                       </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">send_adv_reserved_size </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> SCAN_SEND_ADV_RESERVED_SIZE</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                 </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">controller_debug_flag </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONTROLLER_ADV_LOST_DEBUG_BIT</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">mode </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> BTDM_CONTROLLER_MODE_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                                      </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">ble_max_conn </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_BLE_MAX_CONN_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                     </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">bt_max_acl_conn </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_BR_EDR_MAX_ACL_CONN_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">           </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">bt_sco_datapath </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_BR_EDR_SCO_DATA_PATH_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">          </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">auto_latency </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> BTDM_CTRL_AUTO_LATENCY_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                            </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">bt_legacy_auth_vs_evt </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> BTDM_CTRL_LEGACY_AUTH_VENDOR_EVT_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">         </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">bt_max_sync_conn </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_BR_EDR_MAX_SYNC_CONN_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">         </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">ble_sca </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_BLE_SLEEP_CLOCK_ACCURACY_INDEX_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">             </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">pcm_role </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_PCM_ROLE_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                             </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">pcm_polar </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> CONFIG_BTDM_CTRL_PCM_POLAR_EFF</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                           </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa">    </span><span class="token macro property expression punctuation" style="color:#393A34">.</span><span class="token macro property expression" style="color:#36acaa">magic </span><span class="token macro property expression operator" style="color:#393A34">=</span><span class="token macro property expression" style="color:#36acaa"> ESP_BT_CONTROLLER_CONFIG_MAGIC_VAL</span><span class="token macro property expression punctuation" style="color:#393A34">,</span><span class="token macro property expression" style="color:#36acaa">                           </span><span class="token macro property punctuation" style="color:#393A34">\</span><span class="token macro property" style="color:#36acaa"></span><br></span><span class="token-line" style="color:#393A34"><span class="token macro property" style="color:#36acaa"></span><span class="token macro property expression punctuation" style="color:#393A34">}</span><span class="token macro property expression punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">esp_bt_controller_config_t</span><span class="token plain"> bt_cfg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">BT_CONTROLLER_INIT_CONFIG_DEFAULT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_bt_controller_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">bt_cfg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s initialize controller failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_bt_controller_enable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ESP_BT_MODE_CLASSIC_BT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s enable controller failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>bluedroid 초기화 및 Enable</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_bluedroid_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s initialize bluedroid failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_bluedroid_enable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s enable bluedroid failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>BT 및 SPP 콜백함수 등록</summary><div><div class="collapsibleContent_i85q"><ol><li>ESP_SPP_INIT_EVT -&gt; ESP_SPP_START_EVT<br>처음 bt_spp_acceptor 펌웨어 실행 시 발생</li><li>ESP_SPP_OPEN_EVT<br>안드로이드 앱에서 ESP32 블루투스 연결 시 발생</li><li>ESP_SPP_DATA_IND_EVT
안도르오드 앱에서 패킷 전송 시 발생</li></ol><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">//========================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// BT GAP callback events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 다음 이벤트가 발생하면 esp_bt_gap_cb() 콜백함수가 호출되어 발생한 이벤트를 처리한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_DISC_RES_EVT </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">// Device discovery result event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_DISC_STATE_CHANGED_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Discovery state changed event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_RMT_SRVCS_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// Get remote services event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_RMT_SRVC_REC_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">              </span><span class="token comment" style="color:#999988;font-style:italic">// Get remote service record event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_AUTH_CMPL_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// Authentication complete event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_PIN_REQ_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// Legacy Pairing Pin code request</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_CFM_REQ_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// Security Simple Pairing User Confirmation request.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_KEY_NOTIF_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                 </span><span class="token comment" style="color:#999988;font-style:italic">// Security Simple Pairing Passkey Notification</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_KEY_REQ_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// Security Simple Pairing Passkey request</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_READ_RSSI_DELTA_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// Read rssi event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_CONFIG_EIR_DATA_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// Config EIR data event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_SET_AFH_CHANNELS_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Set AFH channels event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_READ_REMOTE_NAME_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// Read Remote Name event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_MODE_CHG_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_REMOVE_BOND_DEV_COMPLETE_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// remove bond device complete event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_QOS_CMPL_EVT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic">// QOS complete event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_BT_GAP_EVT_MAX</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token class-name">esp_bt_gap_cb_event_t</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_bt_gap_register_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">esp_bt_gap_cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s gap register failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//========================</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// BT GAP callback events</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 다음 이벤트가 발생하면 esp_spp_cb() 콜백함수가 호출되어 발생한 이벤트를 처리한다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_INIT_EVT            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP is inited, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_UNINIT_EVT          </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP is uninited, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_DISCOVERY_COMP_EVT  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// When SDP discovery complete, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_OPEN_EVT            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP Client connection open, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_CLOSE_EVT           </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP connection closed, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_START_EVT           </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP server started, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_CL_INIT_EVT         </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP client initiated a connection, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_DATA_IND_EVT        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP connection received data, the event comes, only for ESP_SPP_MODE_CB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_CONG_EVT            </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP connection congestion status changed, the event comes, only for ESP_SPP_MODE_CB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_WRITE_EVT           </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP write operation completes, the event comes, only for ESP_SPP_MODE_CB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_SRV_OPEN_EVT        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">34</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP Server connection open, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ESP_SPP_SRV_STOP_EVT        </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// When SPP server stopped, the event comes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token class-name">esp_spp_cb_event_t</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_spp_register_callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">esp_spp_cb</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s spp register failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>SPP 초기화</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_spp_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">esp_spp_mode</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> ESP_OK</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">ESP_LOGE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SPP_TAG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%s spp init failed: %s\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">__func__</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">esp_err_to_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ret</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>BT Security 설정</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">if</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">CONFIG_BT_SSP_ENABLED </span><span class="token macro property expression operator" style="color:#393A34">==</span><span class="token macro property expression" style="color:#36acaa"> true</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/* Set default parameters for Secure Simple Pairing</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  esp_bt_sp_param_t param_type = ESP_BT_SP_IOCAP_MODE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  esp_bt_io_cap_t iocap = ESP_BT_IO_CAP_IO;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  esp_bt_gap_set_security_param(param_type, &amp;iocap, sizeof(uint8_t));</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Paring PinCode 설정</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Set default parameters for Legacy Pairing</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * Use variable pin, input pin code when pairing</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="display:inline-block;color:#999988;font-style:italic"></span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">esp_bt_pin_type_t pin_type = ESP_BT_PIN_TYPE_VARIABLE;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">esp_bt_pin_code_t pin_code;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">esp_bt_gap_set_pin(pin_type, 0, pin_code);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인">예제확인<a class="hash-link" href="#예제확인" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="bt_spp_acceptor">bt_spp_acceptor<a class="hash-link" href="#bt_spp_acceptor" title="Direct link to heading">​</a></h5><p>example_spp_acceptor_demo.c -&gt; 동작확인완료</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료">참고자료<a class="hash-link" href="#참고자료" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="ble-개념">BLE 개념<a class="hash-link" href="#ble-개념" title="Direct link to heading">​</a></h5><ul><li><a href="https://enidanny.github.io/ble/" target="_blank" rel="noopener noreferrer">BLE 정리 by 임베디드 개발장이</a><ul><li><a href="https://enidanny.github.io/ble/what-is-the-ble/" target="_blank" rel="noopener noreferrer">BLE (1) - 저전력 블루투스 (BLE) 란?</a></li><li><a href="https://enidanny.github.io/ble/ble-protocol-stack/" target="_blank" rel="noopener noreferrer">BLE (2) - BLE 프로토콜 스택</a></li><li><a href="https://enidanny.github.io/ble/ble-att-gatt/" target="_blank" rel="noopener noreferrer">BLE (3) - ATT/GATT 이해하기</a></li><li><a href="https://enidanny.github.io/ble/ble-connection/" target="_blank" rel="noopener noreferrer">BLE (4) - BLE 디바이스는 어떻게 연결할까?</a></li><li><a href="https://enidanny.github.io/ble/ble-effective-throughput/" target="_blank" rel="noopener noreferrer">BLE (5) - BLE 통신 속도는 실제로 1 Mbps 일까?</a></li><li><a href="https://enidanny.github.io/ble/ble5-intro/" target="_blank" rel="noopener noreferrer">BLE (6) - BLE 5.0 주요 특징</a></li><li><a href="https://enidanny.github.io/ble/ble-slave-latency/" target="_blank" rel="noopener noreferrer">BLE (7) - 연결 파라미터</a></li><li><a href="https://enidanny.github.io/ble/ble-development/" target="_blank" rel="noopener noreferrer">BLE (8) - Nordic BLE Chip 개발환경 구축하기</a></li><li><a href="https://enidanny.github.io/ble/ble-mesh/" target="_blank" rel="noopener noreferrer">BLE (9) - 블루투스 메시: Overview of Mesh stack</a></li><li><a href="https://enidanny.github.io/ble/ble-mesh-opeartion/" target="_blank" rel="noopener noreferrer">BLE (10) - 블루투스 메시: Overview of Mesh operation</a></li><li><a href="https://enidanny.github.io/ble/ble-mesh-concepts/" target="_blank" rel="noopener noreferrer">BLE (11) - 블루투스 메시: Overview of Mesh concepts</a></li><li><a href="https://enidanny.github.io/ble/ble-mesh-message/" target="_blank" rel="noopener noreferrer">BLE (12) - 블루투스 메시: Advertising Bearer 포맷</a></li><li><a href="https://enidanny.github.io/ble/ble-bluetooth-news-51/" target="_blank" rel="noopener noreferrer">BLE (13) - 블루투스 소식: Bluetooth 5.1</a></li><li><a href="https://enidanny.github.io/ble/ble-bluetooth-52/" target="_blank" rel="noopener noreferrer">BLE (14) - 새로운 무선 오디오 시장의 시작: Bluetooth 5.2</a></li><li><a href="https://enidanny.github.io/ble/ble-bluetooth53/" target="_blank" rel="noopener noreferrer">BLE (15) - Bluetooth 5.3 에서 개선 및 추가된 BLE 기능</a></li></ul></li><li>블루투스 앱<ul><li><a href="https://karrel.tistory.com/m/15" target="_blank" rel="noopener noreferrer">블루투스 SPP를 위한 샘플 앱 개발</a></li><li><a href="http://jinyongjeong.github.io/2018/09/27/bluetoothpairing/" target="_blank" rel="noopener noreferrer">안드로이드 어플에서 직접 주변기기를 검색하고 pairing 하는 방법</a></li><li><a href="https://www.hardcopyworld.com/?p=" target="_blank" rel="noopener noreferrer">홈 오토메이션을 위한 모바일 앱 만들기</a></li></ul></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="아두이노">아두이노<a class="hash-link" href="#아두이노" title="Direct link to heading">​</a></h5><p>아두이노에서 제공하는 라이브러리를 이용하면 블루투스 통신을 매우 간단하게 구현할 수 있다.</p><ul><li><a href="https://arsviator.blogspot.com/2019/07/esp32-spp-profile.html" target="_blank" rel="noopener noreferrer">ESP32에서 블루투스 사용하기</a></li><li><a href="https://velog.io/@embeddedjune/BLE-%EA%B0%9C%EB%B0%9C-%EA%B4%80%EB%A0%A8-%EB%82%B4%EC%9A%A9-%EC%A0%95%EB%A6%AC" target="_blank" rel="noopener noreferrer">Arduino-ESP32-BLE 개발 관련 내용 정리 - 쉽게 설명, Good</a></li><li><a href="https://www.bneware.com/blogPost/esp32_arduino_bluetooth" target="_blank" rel="noopener noreferrer">ESP32 아두이노 블루투스 테스트 - 아주 쉬움</a></li><li><a href="https://github.com/fbiego/ESP32_BLE_OTA_Arduino/blob/main/esp32_nim_ble_ota/esp32_nim_ble_ota.ino" target="_blank" rel="noopener noreferrer">ESP32_BLE_OTA_Arduino</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="esp-idf">ESP-IDF<a class="hash-link" href="#esp-idf" title="Direct link to heading">​</a></h5><ul><li><a href="https://www.espressif.com/sites/default/files/documentation/esp32_bluetooth_architecture_en.pdf" target="_blank" rel="noopener noreferrer">ESP32 Bluetooth Architecture</a></li><li><a href="https://higaski.at/aoihashi-esp32-bluetooth-serial-module/" target="_blank" rel="noopener noreferrer">ESP32 bluetooth serial module</a></li><li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/system/ota.html#secure-ota-updates-without-secure-boot" target="_blank" rel="noopener noreferrer">Over The Air Updates (OTA)</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="nordic-nrf51-dk">Nordic nRF51-DK<a class="hash-link" href="#nordic-nrf51-dk" title="Direct link to heading">​</a></h5><p>ESP32는 소스코드를 제공하지 않는 반면 nRF 시리즈는 소스코드를 제공하고, mbed도 지원함.</p><ul><li><a href="https://www.youtube.com/watch?v=LdY2m_bZTgE" target="_blank" rel="noopener noreferrer">nRF51 DK FOTA 컨셉 및 예제 프로젝트 실행방법 from 유투브</a></li><li><a href="https://os.mbed.com/platforms/Nordic-nRF51-DK/#support-for-fota" target="_blank" rel="noopener noreferrer">support arm mbed and fota</a></li><li><a href="https://docs.google.com/viewer?url=http%3A%2F%2Finfocenter.nordicsemi.com%2Fpdf%2FnRF51_Dongle_UG_v1.0.pdf&amp;embedded=true&amp;chrome=false&amp;dov=1" target="_blank" rel="noopener noreferrer">nRF51 Dongle SDK</a> - 가격: <a href="https://www.eleparts.co.kr/goods/view?no=9378612" target="_blank" rel="noopener noreferrer">엘레파츠 12만원</a></li><li><a href="https://docs.google.com/viewer?url=https%3A%2F%2Finfocenter.nordicsemi.com%2Fpdf%2FnRF51_DK_UG_v1.1.pdf&amp;embedded=true&amp;chrome=false&amp;dov=1" target="_blank" rel="noopener noreferrer">NRF51-DK SDK</a> - 가격: <a href="https://eleparts.co.kr/EPXKTGB3" target="_blank" rel="noopener noreferrer">엘레파츠 6만원</a></li><li><a href="https://m.blog.naver.com/PostView.naver?blogId=cksung71&amp;logNo=221262064390&amp;targetKeyword=&amp;targetRecommendationCode=1" target="_blank" rel="noopener noreferrer">SEGGER Embedded Studio for nRF5</a></li><li><a href="https://devzone.nordicsemi.com/nordic/short-range-guides/b/software-development-kit/posts/setting-up-device-firmware-updatedfu-on-the-nrf5-d" target="_blank" rel="noopener noreferrer">nRF5 DK에서 장치 펌웨어 업데이트(DFU) 설정</a></li><li><a href="https://m.blog.naver.com/PostView.naver?blogId=cksung71&amp;logNo=221262064390&amp;targetKeyword=&amp;targetRecommendationCode=1" target="_blank" rel="noopener noreferrer">완전 무료 개발 툴 : SEGGER Embedded Studio</a></li><li><a href="https://www.youtube.com/watch?v=YZouRE_Ol8g&amp;t=18s" target="_blank" rel="noopener noreferrer">SEGGER Embedded studio – Getting started from 유투브</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_ble_uart">FW_BLE_UART<a class="hash-link" href="#fw_ble_uart" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-1">예제확인<a class="hash-link" href="#예제확인-1" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="프로젝트-이름-변경">프로젝트 이름 변경<a class="hash-link" href="#프로젝트-이름-변경" title="Direct link to heading">​</a></h5><ol><li>ESP-IDF 블루투스 예제 프로젝트 생성</li><li>이클립스 프로젝트이름 변경<br>bt_spp_acceptor -&gt; bt_uart로 변경</li><li>main()함수가 있는 파일명 변경<br>example_spp_acceptor_demo.c -&gt; bt_uart.c로 변경</li><li>빌드 시 참고되는 소스파일 명 변경<br>CMakeLists.txt 파일 Open<br>SRCS를 example_spp_acceptor_demo.c -&gt; bt_uart.c로 변경</li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="menuconfig에-uart설정-추가">menuconfig에 UART설정 추가<a class="hash-link" href="#menuconfig에-uart설정-추가" title="Direct link to heading">​</a></h5><ol><li>ESP-IDF UART 예제프로젝트에서 Kconfig.projbuild 복사하여</li><li>bt_uart 프로젝트 main 폴더에 붙여넣기</li><li>기존에 생성한 build 폴더 삭제 후 빌드 재수행</li><li>설정파일 열기<br>콘솔(ESP-IDF 4.3 CMD)에서 idf.py menuconfig or 이클립스에서 sdkconfig 더블클릭</li><li>menuconfig에서 추가된 UART 확인</li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="코드구현">코드구현<a class="hash-link" href="#코드구현" title="Direct link to heading">​</a></h5><ul><li><a href="https://gitlab.com/private210/ewserver/-/blob/main/function/bt_uart/main/bt_uart.c" target="_blank" rel="noopener noreferrer">gitlab login 후 링크확인</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_can">FW_CAN<a class="hash-link" href="#fw_can" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론-1">기초이론<a class="hash-link" href="#기초이론-1" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="can구성">CAN구성<a class="hash-link" href="#can구성" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스-1">인터페이스<a class="hash-link" href="#인터페이스-1" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정-1">레지스터설정<a class="hash-link" href="#레지스터설정-1" title="Direct link to heading">​</a></h5><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-2">예제확인<a class="hash-link" href="#예제확인-2" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="timer_group">timer_group<a class="hash-link" href="#timer_group" title="Direct link to heading">​</a></h5><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료-1">참고자료<a class="hash-link" href="#참고자료-1" title="Direct link to heading">​</a></h4><ul><li><a href="https://arsviator.blogspot.com/2019/06/esp32-can-bus.html" target="_blank" rel="noopener noreferrer">ESP32에서 CAN bus 사용하기</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_gpio">FW_GPIO<a class="hash-link" href="#fw_gpio" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론-2"><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/gpio.html" target="_blank" rel="noopener noreferrer">기초이론</a><a class="hash-link" href="#기초이론-2" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="기능-1">기능<a class="hash-link" href="#기능-1" title="Direct link to heading">​</a></h5><ul><li>34개의 physical GPIO pad를 갖는데 이중 몇몇은 사용 불가능함.</li><li>각 패드는 GPIO 또는 internal peripherals signal로 연결하여 사용될 수 있다.</li></ul><p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_gpio1_pinmap-7e35a08be2be04140abbfce79824858c.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;GPIO Alternative Configuration&gt;</em></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스-2">인터페이스<a class="hash-link" href="#인터페이스-2" title="Direct link to heading">​</a></h5><ul><li>출력설정 : GPIO18, GPIO19 포트로 0/1 신호 출력</li><li>입력설정 : GPIO4(both edge), GPIO5(rising edge) 포트로 인터럽트(EXT_INT) 신호 입력</li></ul><p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_gpio2_interface-fb3f2c5038c9e110965ebbddb79664af.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;입/출력 포트 정의&gt;</em></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정-2">레지스터설정<a class="hash-link" href="#레지스터설정-2" title="Direct link to heading">​</a></h5><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-3">예제확인<a class="hash-link" href="#예제확인-3" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="generic_gpio">generic_gpio<a class="hash-link" href="#generic_gpio" title="Direct link to heading">​</a></h5><p><a href="https://gitlab.com/private210/ewserver/-/blob/main/peripherals/esp32/generic_gpio/main/gpio_example_main.c" target="_blank" rel="noopener noreferrer"><code>gitlab 로그인 -&gt; private repository -&gt; generic_gpio.c</code></a></p><p>다음과 같이 console printf, gpio, ext_int, create_task, queue 동작을 확인한다.</p><ol><li>1s 간격으로 GPIO18, GPIO19 출력 Toggling</li><li>GPIO4(both edge), GPIO5(rising edge) 포트를 통해 인터럽트가 발생하면 포트번호를 인자로 갖는 xQueueSendFromISR 발생</li><li>Task에서 Queue 수신 시 포트번호/신호레벨 printf</li></ol><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isr_ext_int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 인터러럽트 발생 시 Send_Queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">gpio_task</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">xQueueReceive</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;port_number, port_level&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">app_main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// gpio 출력 설정</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// gpio 입력 설정</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Queue 및 태스크 생성(생성에 성공하면 task는 바로 시작됨)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ext_int isr 등록</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">while</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 1s delay</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// cnt++ print</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// port0 and port1 0/1 toggling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="분석">분석<a class="hash-link" href="#분석" title="Direct link to heading">​</a></h4><p>기본이되는 GPIO toggling 예제프로그램을 통해 프로젝트 구조를 파악한다.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="프로젝트-실행">프로젝트 실행<a class="hash-link" href="#프로젝트-실행" title="Direct link to heading">​</a></h5><p>다음 절차를 통해 ESP에서 제공하는 예제프로젝트를 생성한다.</p><ol><li>esp32-idf eclipse에서 File-&gt;New-&gt;Espressif IDF Project를 선택한다.
여기서는 peripherals-&gt;gpio-&gt;<code>generic_gpio</code> 프로젝트를 선택한다.<p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_gpio3_prj_create-62f2f1536217076193ad8db0d233a97a.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;esp32-idf에저 제공되는 gpio 예제프로젝트 생성&gt;</em></p></li><li>타겟을 esp32로 선택한 다음 Build&amp;Run을 통해 ESP32보드에 실행파일을 다운로드 한다.<p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_gpio4_prj_create-8c6b31271dfd0d67e03780fc9dfbef97.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;프로젝트 빌드 및 실행&gt;</em></p></li><li>esp32-idf eclipse에서 제공되는 터미널을 통해 printf 출력을 모니터링 한다.<br>Window 탭 -&gt; Show view -&gt; terminal<p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_gpio5_prj_create-e86dba2a1ec6da33a4354f52eb06b3fd.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;printf 콘솔 모니터링&gt;</em></p></li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="프로젝트-구조">프로젝트 구조<a class="hash-link" href="#프로젝트-구조" title="Direct link to heading">​</a></h5><p>Basic Firmware(led blinking)에 대한 분석을 통해 프로젝트 구조를 파악한다.</p><ul><li>esp32-idf에서 제공되는 예제 프로젝트는 다음과 같은 구조로 프로젝트를 생성하며,
build 폴더 하위경로에 esp-idf sdk directory 구조와 동일하게 폴더를 생성한다.</li><li>esp-idf sdk에 있는 소스를 빌드하여 library(<em>.a) 파일로 만들어 build 폴더 하위 경로에 library(</em>.a) 파일을 생성/링킹한다.</li><li>따라서 프로젝트에는 main.c파일만 생성되며, 이외의 파일은 library(*.a) 파일로 존재하며, 원본소스를 확인하려면 esp-idf sdk 설치경로(C:\Users\cdshim\esp\esp-idf)에 있는 소스파일을 확인해야 한다.</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">generic_gpio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ Binaries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┣━ bootloader</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┗━ generic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gpio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">elf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┣━ bootloader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┗━ esp</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">idf             </span><span class="token comment" style="color:#999988;font-style:italic">// esp-idf sdk의</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃       ┣━ bootloader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃       ┗━ driver          </span><span class="token comment" style="color:#999988;font-style:italic">// driver 폴더에 위치한 소스를 빌드하여</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃          ┗━ libdriver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">a  </span><span class="token comment" style="color:#999988;font-style:italic">// library로 만들어 이곳에 저장</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃             </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┣━ generic</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gpio_main</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">c </span><span class="token comment" style="color:#999988;font-style:italic">// main 소스파일</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┣━ CMakeLists</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┃   ┗━ component</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ CMakeList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ example_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ README</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">md               </span><span class="token comment" style="color:#999988;font-style:italic">// 프로젝트 설명(eclipse에서 markdown 포멧으로 확인가능)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┣━ sdkconfig               </span><span class="token comment" style="color:#999988;font-style:italic">// 더블클릭 -&gt; 프로젝트 관련 설정(= menuconfig)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> ┗━ sdkconfig_old           </span><span class="token comment" style="color:#999988;font-style:italic">// 원본 설정파일</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료-2">참고자료<a class="hash-link" href="#참고자료-2" title="Direct link to heading">​</a></h4><ul><li><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/esp-idf-en-v4.4-dev-3235-g3e370c4-esp32.pdf" target="_blank" rel="noopener noreferrer">ESP32 ESP-IDF Programming Guide(2312p).pdf</a><ul><li>705p, <code>2.3.4 GPIO &amp; RTC GPIO</code></li></ul></li><li><a href="https://www.espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf#iomuxgpio" target="_blank" rel="noopener noreferrer">esp32_technical_reference_manual_en(720p).pdf</a><ul><li>45p, <code>4 IO_MUX and GPIO Matrix (GPIO, IO_MUX)</code></li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_timer">FW_TIMER<a class="hash-link" href="#fw_timer" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론-3"><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/timer.html" target="_blank" rel="noopener noreferrer">기초이론</a><a class="hash-link" href="#기초이론-3" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="기능-2">기능<a class="hash-link" href="#기능-2" title="Direct link to heading">​</a></h5><ul><li>2개의 하드웨어 타이머 그룹을 갖고 있으며, 각 그룹은 2개의 general-purpose hardware timer를 갖고 있다.</li><li>모든 타이머는 16bit prescaler를 갖는 64bit timer로,</li><li>auto-reload를 통해 up/down 카운터로 동작한다.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스-3">인터페이스<a class="hash-link" href="#인터페이스-3" title="Direct link to heading">​</a></h5><p>타이머인터럽트 발생 시 등록해 놓은 콜백함수가 호출되어 메시지를 큐버퍼에 저장하고, main에서 메시지 수신 시 printf를 통해 콜백함수 호출여부를 확인한다.<br>
<!-- -->따라서 printf 만으로 동작을 확인하기 때문에 별도의 인터페이스는 필요없다.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정-3">레지스터설정<a class="hash-link" href="#레지스터설정-3" title="Direct link to heading">​</a></h5><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>파라미터 설정</summary><div><div class="collapsibleContent_i85q"><ul><li>구조체에 값을 설정하여 esp32_api timer_init() 함수에 인자로 설정값을 건네 타이머 초기화를 수행한다.</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">typedef</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">timer_alarm_t</span><span class="token plain"> alarm_en</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Timer alarm enable */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">timer_start_t</span><span class="token plain"> counter_en</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Counter enable */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">timer_intr_mode_t</span><span class="token plain"> intr_type</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Interrupt mode */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">timer_count_dir_t</span><span class="token plain"> counter_dir</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Counter direction  */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">timer_autoreload_t</span><span class="token plain"> auto_reload</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Timer auto-reload */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">uint32_t</span><span class="token plain"> divider</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Counter clock divider. The divider&#x27;s range is from from 2 to 65536. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">if</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression" style="color:#36acaa">SOC_TIMER_GROUP_SUPPORT_XTAL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token class-name">timer_src_clk_t</span><span class="token plain"> clk_src</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*!&lt; Use XTAL as source clock. */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">endif</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token class-name">timer_config_t</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">timer_config_t</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">divider </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TIMER_DIVIDER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">counter_dir </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TIMER_COUNT_UP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">counter_en </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TIMER_PAUSE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">alarm_en </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TIMER_ALARM_EN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">auto_reload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> auto_reload</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// default clock source is APB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">timer_init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Counter Value 설정</summary><div><div class="collapsibleContent_i85q"><p>초기화 후 다음과 같이 타아머카운트 시작값을 설정하며, auto_reload값이 설정되어 있으면 overflow 발생 후 auto_reload로 값애 재설정되고, 그렇치 않을 경우 최초 타이머카운트 시작값으로 다시 카운트를 시작한다.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">timer_set_counter_value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>timer alarm 설정 및 timer enable</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">timer_set_alarm_value</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer_interval_sec </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> TIMER_SCALE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">timer_enable_intr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>콜백함수 등록 후 타이머 시작</summary><div><div class="collapsibleContent_i85q"><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token class-name">example_timer_info_t</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">timer_info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">calloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">example_timer_info_t</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timer_info</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">timer_group </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> group</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timer_info</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">timer_idx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timer_info</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">auto_reload </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> auto_reload</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">timer_info</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">alarm_interval </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> timer_interval_sec</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">timer_isr_callback_add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer_group_isr_callback</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer_info</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">timer_start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">group</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> timer</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-4">예제확인<a class="hash-link" href="#예제확인-4" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="timer_group-1">timer_group<a class="hash-link" href="#timer_group-1" title="Direct link to heading">​</a></h5><ol><li>타이머 설정 및 콜백함수를 등록하여 타이머를 시작</li><li>타이머인터럽트에 의해 콜백함수가 호출되면 큐버퍼에 메시지 전송</li><li>main의 while()문에서 메시지 수신을 대기하고 있다가 메시지를 수신하면 타이머카운트 값, 인터럽트가 발생된 타이머 그룹, 타이머 정보 printf</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_uart">FW_UART<a class="hash-link" href="#fw_uart" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론-4"><a href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/uart.html" target="_blank" rel="noopener noreferrer">기초이론</a><a class="hash-link" href="#기초이론-4" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="기능-3">기능<a class="hash-link" href="#기능-3" title="Direct link to heading">​</a></h5><ul><li>ESP32는 3개(UART0, UART1, UART2)의 UART Controller를 가지고 있고,</li><li>이중 UART0은 모니터링용으로, UART2는 타겟 MCU와의 데이터 송/수신을 위해 사용한다.</li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스-4">인터페이스<a class="hash-link" href="#인터페이스-4" title="Direct link to heading">​</a></h5><p><a href="https://www.devicemart.co.kr/goods/view?no=1324910" target="_blank" rel="noopener noreferrer"><code>CP2102 USB to TTL 컨버터</code>(디바이스마트, 2750원 판매)</a>를 통해 타겟 MCU와 통신을 수행한다.</p><ul><li>UART0<ul><li>RX0(GPIO3), TX0(GPIO1)</li><li>Onboard 되어있는 usb to uart chip(CP2102N)에 연결되어 usb를 통해 가상 시리얼 포트로 사용되며, 주로 콘솔 모니터링을 위해 사용한다.</li></ul></li><li>UART2<ul><li>RX2(GPIO5), TX2(GPIO4)</li><li>제어기와 연결되어 블루투스를 통해 수신한 정보를 제어기로 전달하기 위해 사용한다.</li></ul></li><li>USB to UART 컨버터<ul><li><a href="https://www.waveshare.com/wiki/FT232_USB_UART_Board_(mini)" target="_blank" rel="noopener noreferrer">FT232 USB UART Board (mini)</a><ul><li><a href="https://www.eleparts.co.kr/goods/view?no=2305017" target="_blank" rel="noopener noreferrer">엘레파츠 6600원 판매</a></li><li><a href="https://www.waveshare.com/wiki/File:FT232-Driver.7z" target="_blank" rel="noopener noreferrer">드라이버 다운로드</a></li><li><a href="https://www.waveshare.com/w/upload/f/f4/FT232-USB-UART-Board-Schematic.pdf" target="_blank" rel="noopener noreferrer">Board Schematic</a></li><li><a href="https://www.waveshare.com/w/upload/b/b5/FT232R.pdf" target="_blank" rel="noopener noreferrer">FT232RL CPU Datasheet</a></li></ul></li><li><del>CP2102 USB to TTL Uart Serial Converter</del><ul><li><a href="https://www.devicemart.co.kr/goods/view?no=1324910" target="_blank" rel="noopener noreferrer"><del>디바이스마트, 2750원 판매</del></a></li></ul></li><li>21.10.03 장치인식 문제<ul><li><code>CP2102 USB to TTL Uart Serial Converter</code>는 사용 안함 (사용하기에는 이게 더 편함)</li><li>기존에 사용했던 <code>FT232 USB UART Board (mini)</code> 사용함</li></ul></li></ul></li></ul><p align="center"><img loading="lazy" src="/webpage/assets/images/mbd_hw_fw_uart1_interface-9f6b41d5d808d467b11ce5310ead38e3.png" alt="Example banner" width="350" class="img_ev3q"><br><em>&lt;입/출력 포트 정의&gt;</em></p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정-4">레지스터설정<a class="hash-link" href="#레지스터설정-4" title="Direct link to heading">​</a></h5><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>파라미터 설정</summary><div><div class="collapsibleContent_i85q"><ul><li>uart_param_config() 함수를 1번 호출하여 한번에 설정하는 방법과,</li><li>uart_set_baudrate(), uart_set_word_length(), uart_set_parity() 등과 같이 각 단계를 각각의 함수를 호출하여 각각 설정하는 방법이 있으며,</li><li>여기서는 config() 함수를 이용하여 한번에 UART 파라미터를 설정한다.</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">uart_port_t</span><span class="token plain"> uart_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_NUM_2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">uart_config_t</span><span class="token plain"> uart_config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">baud_rate </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115200</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_DATA_8_BITS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_PARITY_DISABLE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stop_bits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_STOP_BITS_1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flow_ctrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_HW_FLOWCTRL_CTS_RTS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">rx_flow_ctrl_thresh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">122</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ESP_ERROR_CHECK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">uart_param_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 설정함수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  uart_num</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// UART 0/1/2 중 하나</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">uart_config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// 설정 파라미터</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>UART pin 설정</summary><div><div class="collapsibleContent_i85q"><p>uart_set_pin() 함수를 이용하여 출력핀을 설정한다.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ESP_ERROR_CHECK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">uart_set_pin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  UART_NUM_2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// UART2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// TX2 : GPIO4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic">// RX2 : GPIO5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// RTS: GPIO18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">             </span><span class="token comment" style="color:#999988;font-style:italic">// CTS: GPIO19</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>드라이버 설정</summary><div><div class="collapsibleContent_i85q"><p>Rx/Tx ring buffer size, event queue handle을 설정한다.</p><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Setup UART buffered IO with event queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> uart_buffer_size </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">QueueHandle_t uart_queue</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Install UART driver using an event queue here</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ESP_ERROR_CHECK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">uart_driver_install</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  UART_NUM_2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> uart_buffer_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  uart_buffer_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">uart_queue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>데이터 송신</summary><div><div class="collapsibleContent_i85q"><p>시리얼 통신은 각 UART controller의 Finite State Machine(FSM)에 의해 제어된다.</p><ul><li><code>uart_write_bytes()</code> 함수를 이용하여 Tx FIFO 버퍼에 데이터 write</li><li>Tx FIFO buffer에 free space가 있으면 ISR이 background에서 데이터를 Tx ring buffer에서 Tx FIFO로 전송한다.</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Write data to UART.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">char</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> test_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;This is a test string.\n&quot;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">uart_write_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uart_num</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">char</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">test_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">strlen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">test_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>데이터 수신</summary><div><div class="collapsibleContent_i85q"><ul><li>UART 데이터를 수신하면 Rx FIFO buffer에 저장</li><li>uart_get_buffered_data_len() 함수를 이용하여 Rx FIFO에서 읽을 수 있는 byte 수 확인</li><li>uart_read_bytes() 함수를 이용하여 수신 데이터 읽기</li></ul><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Read data from UART.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token class-name">uart_port_t</span><span class="token plain"> uart_num </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> UART_NUM_2</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">uint8_t</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ESP_ERROR_CHECK</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">uart_get_buffered_data_len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uart_num</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">size_t</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">length</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">length </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uart_read_bytes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uart_num</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> length</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-5">예제확인<a class="hash-link" href="#예제확인-5" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="uart_echo">uart_echo<a class="hash-link" href="#uart_echo" title="Direct link to heading">​</a></h5><p><a href="https://gitlab.com/private210/ewserver/-/blob/main/peripherals/esp32/uart_echo/main/uart_echo_example_main.c" target="_blank" rel="noopener noreferrer"><code>gitlab 로그인 -&gt; private repository -&gt; uart_echo_example_main.c</code></a></p><p>다음과 같이 console printf 및 loopback(GPIO4_Tx2, GPIO5_Rx2) 동작을 확인한다.</p><ol><li>Task 생성/시작 전 console printf</li><li>loopback task 생성</li><li>일정시간동안 패킷 수신 대기</li><li>수신된 패킷 송신</li></ol><h5 class="anchor anchorWithStickyNavbar_LWe7" id="uart_async_rxtxtasks">uart_async_rxtxtasks<a class="hash-link" href="#uart_async_rxtxtasks" title="Direct link to heading">​</a></h5><p><a href="https://gitlab.com/private210/ewserver/-/blob/main/peripherals/esp32/uart_async_rxtxtasks/main/uart_async_rxtxtasks_main.c" target="_blank" rel="noopener noreferrer"><code>gitlab 로그인 -&gt; private repository -&gt; uart_async_rxtxtasks_main.c</code></a></p><p>다음과 같이 console printf, GPIO4_Tx2, GPIO5_Rx2 동작을 확인한다.</p><ol><li>Task 생성/시작 전 console printf</li><li>rx_task, tx_task 생성</li><li>tx_task에서 주기적으로 &quot;Hello world\n&quot; 메시지 GPIO4_Tx2</li><li>rx_task에서 bytes 수신 시 log 출력</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료-3">참고자료<a class="hash-link" href="#참고자료-3" title="Direct link to heading">​</a></h4><ul><li>ESP32 ESP-IDF Programming Guide(2312p).pdf -&gt; 900p, 2.3.21 Universal Asynchronous Receiver/Transmitter (UART)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fw_wifi">FW_WIFI<a class="hash-link" href="#fw_wifi" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기초이론-5">기초이론<a class="hash-link" href="#기초이론-5" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="wifi구성">WIFI구성<a class="hash-link" href="#wifi구성" title="Direct link to heading">​</a></h5><p>Bluetooth와는 다르게 Wifi를 통해 임베디드 웹서버를 구축하면 웹브라우저만 있으면 ESP32에 접속하는 Client에서 블루투스 앱과 같은 별도 프로그램 없이 GUI를 구현할 수 있다.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="인터페이스-5">인터페이스<a class="hash-link" href="#인터페이스-5" title="Direct link to heading">​</a></h5><h5 class="anchor anchorWithStickyNavbar_LWe7" id="레지스터설정-5">레지스터설정<a class="hash-link" href="#레지스터설정-5" title="Direct link to heading">​</a></h5><h4 class="anchor anchorWithStickyNavbar_LWe7" id="예제확인-6">예제확인<a class="hash-link" href="#예제확인-6" title="Direct link to heading">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료-4">참고자료<a class="hash-link" href="#참고자료-4" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="wifi">wifi<a class="hash-link" href="#wifi" title="Direct link to heading">​</a></h5><ul><li><a href="https://docs.espressif.com/projects/esp-idf/en/stable/api-guides/wifi.html" target="_blank" rel="noopener noreferrer">wifi programming</a></li><li><a href="https://coyoteugly.tistory.com/148" target="_blank" rel="noopener noreferrer">ESP32 blufi(Bluetooth로 ip/pw등 연결설정하여 연결되면 wifi로 통신)</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="아두이노-1">아두이노<a class="hash-link" href="#아두이노-1" title="Direct link to heading">​</a></h5><ul><li><a href="https://arsviator.blogspot.com/2018/07/esp32-websocket-server-on-esp32.html" target="_blank" rel="noopener noreferrer">아두이노 및 파이썬을 이용하여 ESP32에서 웹소켓 서버 실행</a></li><li><a href="https://arsviator.blogspot.com/2018/07/esp32-json.html" target="_blank" rel="noopener noreferrer">ESP32에서 JSON 파싱(for 실시간 웹페이지 업데이트)</a></li><li><a href="https://arsviator.blogspot.com/2018/11/esp32-static-ip-using-static-ip-address.html" target="_blank" rel="noopener noreferrer">ESP32에 static IP 사용하기</a></li><li><a href="https://www.electronicshub.org/esp32-servo-control/" target="_blank" rel="noopener noreferrer">ESP32’s Web page accessed using Chrome browser - 끝부분</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rtos_sync">RTOS_Sync<a class="hash-link" href="#rtos_sync" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="기본개념">기본개념<a class="hash-link" href="#기본개념" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="세마포어뮤텍스">세마포어/뮤텍스<a class="hash-link" href="#세마포어뮤텍스" title="Direct link to heading">​</a></h5><ul><li><a href="https://arsviator.blogspot.com/2018/07/esp32-freertos-message-queue.html" target="_blank" rel="noopener noreferrer">FreeRTOS Message Queue 사용</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="큐">큐<a class="hash-link" href="#큐" title="Direct link to heading">​</a></h5><ol><li>boolean 크기를 갖는 데이터를 10개까지 저장할 수 있는 큐를 생성하고, </li><li>인터럽트 수신 즉시 큐에 데이터를 계속 밀어 넣고,</li><li>main에서 큐 데이터를 수신하여 사용한다.</li></ol><div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> bool toggleLED </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> xQueueHandle gpio_evt_queue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">uint8_t</span><span class="token plain"> trigger</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 큐에 있는 데이터를 저장할 변수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">uart_isr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">패킷수신</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toggleLED </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">toggleLED</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">xQueueSend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gpio_evt_queue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">toggleLED</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">NULL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">void</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gpio_evt_queue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">xQueueCreate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// 아이템 최대 개수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">sizeof</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bool</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 각 아이템의 크기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">xQueueReceive</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gpio_evt_queue</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">trigger</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> portMAX_DELAY</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">gpio_set_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">GPIO_OUTPUT_IO_0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trigger</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function" style="color:#d73a49">printf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;# [gpio_task] gpio out: %d\n&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trigger</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h5 class="anchor anchorWithStickyNavbar_LWe7" id="태스크-동기화">태스크 동기화<a class="hash-link" href="#태스크-동기화" title="Direct link to heading">​</a></h5><h4 class="anchor anchorWithStickyNavbar_LWe7" id="참고자료-5">참고자료<a class="hash-link" href="#참고자료-5" title="Direct link to heading">​</a></h4><ul><li><a href="https://docs.aws.amazon.com/ko_kr/freertos/latest/userguide/freertos-ug.pdf" target="_blank" rel="noopener noreferrer">freertos-user guide for aws</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rtos_task">RTOS_Task<a class="hash-link" href="#rtos_task" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="태스크-생성">태스크 생성<a class="hash-link" href="#태스크-생성" title="Direct link to heading">​</a></h4><ul><li>FreeRTOS 기반 태스크 생성 시 <a href="https://arsviator.blogspot.com/2019/04/esp32-use-multicore-on-esp32.html" target="_blank" rel="noopener noreferrer">우선순위, 코어를 선태갛여 태스크를 생성</a>할 수 있다.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="우선순위-설정">우선순위 설정<a class="hash-link" href="#우선순위-설정" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="freertos">FreeRTOS<a class="hash-link" href="#freertos" title="Direct link to heading">​</a></h5><ul><li><a href="https://slowbootkernelhacks.blogspot.com/2020/12/esp32-freertos.html" target="_blank" rel="noopener noreferrer">ESP32로 알아보는 FreeRTOS</a></li><li><a href="https://github.com/aws/amazon-freertos" target="_blank" rel="noopener noreferrer">Amazon FreeRTOS for AWS Cloud</a></li><li><a href="https://velog.io/@embeddedjune/FreeRTOS-%EC%A0%95%EB%A6%AC-%E5%AE%8C.-%EC%B4%9D%EC%A7%91%EB%B3%B8" target="_blank" rel="noopener noreferrer">FreeRTOS 정리 - good</a></li><li><a href="https://velog.io/@embeddedjune/FreeRTOS-%EC%A0%95%EB%A6%AC-1.-FreeRTOS%EC%99%80-Task" target="_blank" rel="noopener noreferrer">FreeRTOS 정리 1. FreeRTOS와 Task</a></li></ul><h5 class="anchor anchorWithStickyNavbar_LWe7" id="mbed">mbed<a class="hash-link" href="#mbed" title="Direct link to heading">​</a></h5><ul><li><a href="https://gcamp.tistory.com/tag/arm_mbed_rtos" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍</a><ul><li><a href="https://www.youtube.com/watch?v=pu8pM536uks&amp;t=5025s" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍 1일</a></li><li><a href="https://www.youtube.com/watch?v=IrZLFODeFoM" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍 2일</a></li><li><a href="https://www.youtube.com/watch?v=BH4AFFJqh_Q" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍 3일</a></li><li><a href="https://www.youtube.com/watch?v=QPpxXiEKAMI" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍 4일</a></li><li><a href="https://www.youtube.com/watch?v=KFSLiFLvuO4" target="_blank" rel="noopener noreferrer">MBED OS(RTOS 포함) 워크숍 5일</a></li></ul></li><li><a href="https://gcamp.tistory.com/tag/arm_mbed?page=3" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics</a><ul><li><a href="https://gcamp.tistory.com/1523" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 01강</a></li><li><a href="https://gcamp.tistory.com/1523" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 02강 디바이스 연결</a></li><li><a href="https://gcamp.tistory.com/1524" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 03강</a></li><li><a href="https://gcamp.tistory.com/1525" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 04강 프로그램 기본 구조</a></li><li><a href="https://gcamp.tistory.com/1526" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 05강 디지털 출력</a></li><li><a href="https://gcamp.tistory.com/1527" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 06강 디지털 입력</a></li><li><a href="https://gcamp.tistory.com/1528" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 07강 PwmOut</a></li><li><a href="https://gcamp.tistory.com/1529" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 08강 아날로그 출력AnalogOut</a></li><li><a href="https://gcamp.tistory.com/1530" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 09강 아날로그 입력 AnalogIn</a></li><li><a href="https://gcamp.tistory.com/1531" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 10강 BusOut</a></li><li><a href="https://gcamp.tistory.com/1532" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 11강 BusIn</a></li><li><a href="https://gcamp.tistory.com/1533" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 12강 토양수분센서</a></li><li><a href="https://gcamp.tistory.com/1534" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 13강 적외선인체감지센서PIR</a></li><li><a href="https://gcamp.tistory.com/1535" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 14강 조도센서CDS</a></li><li><a href="https://gcamp.tistory.com/1536" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 15강 가스센서 불꽃감지센서</a></li><li><a href="https://gcamp.tistory.com/1537" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 16강 거리측정센서</a></li><li><a href="https://gcamp.tistory.com/1538" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 17강 온습도센서</a></li><li><a href="https://gcamp.tistory.com/1539" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 18강 피에조부저</a></li><li><a href="https://gcamp.tistory.com/1540" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 19강 릴레이</a></li><li><a href="https://gcamp.tistory.com/1541" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 20강 진동센서와모터, IR장애물센서</a></li><li><a href="https://gcamp.tistory.com/1542" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 21강 UARTBoardToPc 통신</a></li><li><a href="https://gcamp.tistory.com/1543" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 22강 UARTBoardToBoard 통신</a></li><li><a href="https://gcamp.tistory.com/1544" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 23강 I2C LCD활용 통신</a></li><li><a href="https://gcamp.tistory.com/1545" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 24강 I2C OLED활용 통신</a></li><li><a href="https://gcamp.tistory.com/1546" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 25강 SPI LCD활용 통신</a></li><li><a href="https://gcamp.tistory.com/1547" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 26강 SPI LCD활용 통신</a></li><li><a href="https://gcamp.tistory.com/1548" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 27강 7Segment1digit 사용하기</a></li><li><a href="https://gcamp.tistory.com/1549" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 28강 7Segment4digit 사용하기</a></li><li><a href="https://gcamp.tistory.com/1550" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 29강 LED Matrix8X8사용하기</a></li><li><a href="https://gcamp.tistory.com/1551" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 30강 RTC(DS1302)사용하기</a></li><li><a href="https://gcamp.tistory.com/1552" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 31강 인터럽트Interrupt</a></li><li><a href="https://gcamp.tistory.com/1553" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 32강 반복실행Ticker</a></li><li><a href="https://gcamp.tistory.com/1554" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 33강 시간 측정 Timer</a></li><li><a href="https://gcamp.tistory.com/1555" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 34강 시간 종료Timeout</a></li><li><a href="https://gcamp.tistory.com/1556" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 35강 서보Servo모터</a></li><li><a href="https://gcamp.tistory.com/1557" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 36강 스테핑Stepping모터</a></li><li><a href="https://gcamp.tistory.com/1558" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 37강 DC모터</a></li><li><a href="https://gcamp.tistory.com/1559" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 38강 OnBoardSensor L475</a></li><li><a href="https://gcamp.tistory.com/1560" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 39강 스레드</a></li><li><a href="https://gcamp.tistory.com/1561" target="_blank" rel="noopener noreferrer">Arm MBED Programming Basics 40강 스레드 통신</a></li></ul></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/chuldongshim/webpage/docs/3_sideprj/3_hybrid/c_esp32_hw.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/webpage/docs/sideprj/hybrid/esp32_sys"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">시스템</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/webpage/docs/sideprj/hybrid/esp32_sw"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">소프트웨어</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#사양" class="table-of-contents__link toc-highlight">사양</a><ul><li><a href="#mcu" class="table-of-contents__link toc-highlight">MCU</a></li><li><a href="#mcu비교" class="table-of-contents__link toc-highlight">MCU비교</a></li></ul></li><li><a href="#펌웨어" class="table-of-contents__link toc-highlight">펌웨어</a><ul><li><a href="#부팅과정" class="table-of-contents__link toc-highlight">부팅과정</a></li><li><a href="#fw_ble" class="table-of-contents__link toc-highlight">FW_BLE</a></li><li><a href="#fw_ble_uart" class="table-of-contents__link toc-highlight">FW_BLE_UART</a></li><li><a href="#fw_can" class="table-of-contents__link toc-highlight">FW_CAN</a></li><li><a href="#fw_gpio" class="table-of-contents__link toc-highlight">FW_GPIO</a></li><li><a href="#fw_timer" class="table-of-contents__link toc-highlight">FW_TIMER</a></li><li><a href="#fw_uart" class="table-of-contents__link toc-highlight">FW_UART</a></li><li><a href="#fw_wifi" class="table-of-contents__link toc-highlight">FW_WIFI</a></li><li><a href="#rtos_sync" class="table-of-contents__link toc-highlight">RTOS_Sync</a></li><li><a href="#rtos_task" class="table-of-contents__link toc-highlight">RTOS_Task</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/webpage/docs/mycareer">경력요약</a></li><li class="footer__item"><a class="footer__link-item" href="/webpage/docs/introduce">자기소개</a></li><li class="footer__item"><a class="footer__link-item" href="/webpage/docs/sideprj">사이드프로젝트</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/webpage/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/chuldongshim/webpage" target="_blank" rel="noopener noreferrer" class="footer__link-item">MyGitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc.</div></div></div></footer></div>
<script src="/webpage/assets/js/runtime~main.0fb79a31.js"></script>
<script src="/webpage/assets/js/main.d7834fa7.js"></script>
</body>
</html>